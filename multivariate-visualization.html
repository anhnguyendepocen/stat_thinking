<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Multivariate Visualization | Statistical Reasoning through Computation and R</title>
  <meta name="description" content="Chapter 4 Multivariate Visualization | Statistical Reasoning through Computation and R" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Multivariate Visualization | Statistical Reasoning through Computation and R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="true" />
  
  
  <meta name="github-repo" content="lebebr01/stat_thinking" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Multivariate Visualization | Statistical Reasoning through Computation and R" />
  
  
  

<meta name="author" content="Brandon LeBeau and Andrew S. Zieffler" />


<meta name="date" content="2020-07-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="descriptive-statistics-numerically-describing-the-sample-data.html"/>
<link rel="next" href="classification.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Reasoning through Computation and R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#statistics-vs-data-science"><i class="fa fa-check"></i><b>1.1</b> Statistics vs Data Science</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#experiments-vs-observations"><i class="fa fa-check"></i><b>1.2</b> Experiments vs Observations</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#data-structure"><i class="fa fa-check"></i><b>1.3</b> Data Structure</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>2</b> Visualization</a><ul>
<li class="chapter" data-level="2.0.1" data-path="visualization.html"><a href="visualization.html#college-scorecard-data"><i class="fa fa-check"></i><b>2.0.1</b> College Scorecard Data</a></li>
<li class="chapter" data-level="2.0.2" data-path="visualization.html"><a href="visualization.html#view-the-data"><i class="fa fa-check"></i><b>2.0.2</b> View the Data</a></li>
<li class="chapter" data-level="2.1" data-path="visualization.html"><a href="visualization.html#exploring-attributes"><i class="fa fa-check"></i><b>2.1</b> Exploring Attributes</a><ul>
<li class="chapter" data-level="2.1.1" data-path="visualization.html"><a href="visualization.html#histograms"><i class="fa fa-check"></i><b>2.1.1</b> Histograms</a></li>
<li class="chapter" data-level="2.1.2" data-path="visualization.html"><a href="visualization.html#interpretting-histograms"><i class="fa fa-check"></i><b>2.1.2</b> Interpretting Histograms</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="visualization.html"><a href="visualization.html#plot-customization"><i class="fa fa-check"></i><b>2.2</b> Plot Customization</a><ul>
<li class="chapter" data-level="2.2.1" data-path="visualization.html"><a href="visualization.html#axes-labels"><i class="fa fa-check"></i><b>2.2.1</b> Axes labels</a></li>
<li class="chapter" data-level="2.2.2" data-path="visualization.html"><a href="visualization.html#plot-title-and-subtitle"><i class="fa fa-check"></i><b>2.2.2</b> Plot title and subtitle</a></li>
<li class="chapter" data-level="2.2.3" data-path="visualization.html"><a href="visualization.html#plot-theme"><i class="fa fa-check"></i><b>2.2.3</b> Plot theme</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="visualization.html"><a href="visualization.html#density-plots"><i class="fa fa-check"></i><b>2.3</b> Density plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics: Numerically Describing the Sample Data</a><ul>
<li class="chapter" data-level="3.1" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#summarizing-attributes"><i class="fa fa-check"></i><b>3.1</b> Summarizing Attributes</a></li>
<li class="chapter" data-level="3.2" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#understanding-the-median-and-mean"><i class="fa fa-check"></i><b>3.2</b> Understanding the Median and Mean</a><ul>
<li class="chapter" data-level="3.2.1" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#summarize-with-the-mean-or-median"><i class="fa fa-check"></i><b>3.2.1</b> Summarize with the Mean or Median?</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#numerically-summarizing-variation"><i class="fa fa-check"></i><b>3.3</b> Numerically Summarizing Variation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#range"><i class="fa fa-check"></i><b>3.3.1</b> Range</a></li>
<li class="chapter" data-level="3.3.2" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#percentile-range"><i class="fa fa-check"></i><b>3.3.2</b> Percentile Range</a></li>
<li class="chapter" data-level="3.3.3" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#interquartile-range-iqr"><i class="fa fa-check"></i><b>3.3.3</b> Interquartile Range (IQR)</a></li>
<li class="chapter" data-level="3.3.4" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#empirical-cumulative-density"><i class="fa fa-check"></i><b>3.3.4</b> Empirical Cumulative Density</a></li>
<li class="chapter" data-level="3.3.5" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#variance-and-standard-deviation"><i class="fa fa-check"></i><b>3.3.5</b> Variance and Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#summarizing-categorical-attributes"><i class="fa fa-check"></i><b>3.4</b> Summarizing Categorical Attributes</a></li>
<li class="chapter" data-level="3.5" data-path="descriptive-statistics-numerically-describing-the-sample-data.html"><a href="descriptive-statistics-numerically-describing-the-sample-data.html#advanced-extension-computing-your-own-measure-of-variation"><i class="fa fa-check"></i><b>3.5</b> Advanced Extension: Computing Your Own Measure of Variation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html"><i class="fa fa-check"></i><b>4</b> Multivariate Visualization</a><ul>
<li class="chapter" data-level="4.1" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#facetting"><i class="fa fa-check"></i><b>4.1</b> Facetting</a></li>
<li class="chapter" data-level="4.2" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#considering-groups"><i class="fa fa-check"></i><b>4.2</b> Considering Groups</a><ul>
<li class="chapter" data-level="4.2.1" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#adding-additional-groups"><i class="fa fa-check"></i><b>4.2.1</b> Adding additional groups</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#other-statistics-of-center"><i class="fa fa-check"></i><b>4.3</b> Other statistics of center</a></li>
<li class="chapter" data-level="4.4" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#measures-of-variation"><i class="fa fa-check"></i><b>4.4</b> Measures of Variation</a><ul>
<li class="chapter" data-level="4.4.1" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#robust-measure-of-variation"><i class="fa fa-check"></i><b>4.4.1</b> Robust measure of variation</a></li>
<li class="chapter" data-level="4.4.2" data-path="multivariate-visualization.html"><a href="multivariate-visualization.html#variation-by-group"><i class="fa fa-check"></i><b>4.4.2</b> Variation by Group</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>5</b> Classification</a><ul>
<li class="chapter" data-level="5.1" data-path="classification.html"><a href="classification.html#topic-decision-trees"><i class="fa fa-check"></i><b>5.1</b> Topic: Decision Trees</a><ul>
<li class="chapter" data-level="5.1.1" data-path="classification.html"><a href="classification.html#fitting-a-classification-tree"><i class="fa fa-check"></i><b>5.1.1</b> Fitting a Classification Tree</a></li>
<li class="chapter" data-level="5.1.2" data-path="classification.html"><a href="classification.html#pruning-trees"><i class="fa fa-check"></i><b>5.1.2</b> Pruning Trees</a></li>
<li class="chapter" data-level="5.1.3" data-path="classification.html"><a href="classification.html#accuracy"><i class="fa fa-check"></i><b>5.1.3</b> Accuracy</a></li>
<li class="chapter" data-level="5.1.4" data-path="classification.html"><a href="classification.html#comparison-to-baseline"><i class="fa fa-check"></i><b>5.1.4</b> Comparison to Baseline</a></li>
<li class="chapter" data-level="5.1.5" data-path="classification.html"><a href="classification.html#trainingtest-data"><i class="fa fa-check"></i><b>5.1.5</b> Training/Test Data</a></li>
<li class="chapter" data-level="5.1.6" data-path="classification.html"><a href="classification.html#introduction-to-resamplingbootstrap"><i class="fa fa-check"></i><b>5.1.6</b> Introduction to resampling/bootstrap</a></li>
<li class="chapter" data-level="5.1.7" data-path="classification.html"><a href="classification.html#cross-validation"><i class="fa fa-check"></i><b>5.1.7</b> Cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-model.html"><a href="linear-model.html"><i class="fa fa-check"></i><b>6</b> Linear Model</a><ul>
<li class="chapter" data-level="6.1" data-path="linear-model.html"><a href="linear-model.html#regression-trees"><i class="fa fa-check"></i><b>6.1</b> Regression Trees</a><ul>
<li class="chapter" data-level="6.1.1" data-path="linear-model.html"><a href="linear-model.html#visualize-distributions"><i class="fa fa-check"></i><b>6.1.1</b> Visualize distributions</a></li>
<li class="chapter" data-level="6.1.2" data-path="linear-model.html"><a href="linear-model.html#decision-tree---regression-tree"><i class="fa fa-check"></i><b>6.1.2</b> Decision Tree - Regression Tree</a></li>
<li class="chapter" data-level="6.1.3" data-path="linear-model.html"><a href="linear-model.html#evaluating-accuracy"><i class="fa fa-check"></i><b>6.1.3</b> Evaluating accuracy</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="linear-model.html"><a href="linear-model.html#simple-regression-continuous-predictor"><i class="fa fa-check"></i><b>6.2</b> Simple Regression continuous predictor</a><ul>
<li class="chapter" data-level="6.2.1" data-path="linear-model.html"><a href="linear-model.html#description-of-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Description of the Data</a></li>
<li class="chapter" data-level="6.2.2" data-path="linear-model.html"><a href="linear-model.html#scatterplots"><i class="fa fa-check"></i><b>6.2.2</b> Scatterplots</a></li>
<li class="chapter" data-level="6.2.3" data-path="linear-model.html"><a href="linear-model.html#fitting-a-linear-regression-model"><i class="fa fa-check"></i><b>6.2.3</b> Fitting a linear regression model</a></li>
<li class="chapter" data-level="6.2.4" data-path="linear-model.html"><a href="linear-model.html#explore-the-y-intercept"><i class="fa fa-check"></i><b>6.2.4</b> Explore the y-intercept</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="linear-model.html"><a href="linear-model.html#conditional-means"><i class="fa fa-check"></i><b>6.3</b> Conditional Means</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html"><i class="fa fa-check"></i><b>7</b> Estimation / Bootstrap / Uncertainty</a><ul>
<li class="chapter" data-level="7.1" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#estimating-error"><i class="fa fa-check"></i><b>7.1</b> Estimating Error</a></li>
<li class="chapter" data-level="7.2" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#categorical-predictors"><i class="fa fa-check"></i><b>7.2</b> Categorical Predictor(s)</a><ul>
<li class="chapter" data-level="7.2.1" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#mothers-smoking"><i class="fa fa-check"></i><b>7.2.1</b> Mother's smoking</a></li>
<li class="chapter" data-level="7.2.2" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#linear-regression---categorical-predictor"><i class="fa fa-check"></i><b>7.2.2</b> Linear Regression - Categorical Predictor</a></li>
<li class="chapter" data-level="7.2.3" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#inference"><i class="fa fa-check"></i><b>7.2.3</b> Inference</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#more-than-2-categorical-groups"><i class="fa fa-check"></i><b>7.3</b> More than 2 categorical groups</a><ul>
<li class="chapter" data-level="7.3.1" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#explore-distribution-3-groups"><i class="fa fa-check"></i><b>7.3.1</b> Explore distribution 3 groups</a></li>
<li class="chapter" data-level="7.3.2" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#overall-model-fit"><i class="fa fa-check"></i><b>7.3.2</b> Overall model fit</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#multiple-regression"><i class="fa fa-check"></i><b>7.4</b> Multiple Regression</a><ul>
<li class="chapter" data-level="7.4.1" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#interactions"><i class="fa fa-check"></i><b>7.4.1</b> Interactions</a></li>
<li class="chapter" data-level="7.4.2" data-path="estimation-bootstrap-uncertainty.html"><a href="estimation-bootstrap-uncertainty.html#evaluating-model-fit"><i class="fa fa-check"></i><b>7.4.2</b> Evaluating model fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html"><i class="fa fa-check"></i><b>8</b> Prediction for individuals</a><ul>
<li class="chapter" data-level="8.1" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#comparison-of-classification-linear-model"><i class="fa fa-check"></i><b>8.1</b> Comparison of classification / linear model</a></li>
<li class="chapter" data-level="8.2" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#compared-linear-model-with-median"><i class="fa fa-check"></i><b>8.2</b> Compared linear model with median</a><ul>
<li class="chapter" data-level="8.2.1" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#skewed-data---inference"><i class="fa fa-check"></i><b>8.2.1</b> Skewed Data - Inference</a></li>
<li class="chapter" data-level="8.2.2" data-path="prediction-for-individuals.html"><a href="prediction-for-individuals.html#bootstrap-median"><i class="fa fa-check"></i><b>8.2.2</b> Bootstrap Median</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Reasoning through Computation and R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate-visualization" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Multivariate Visualization</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(ggformula)
<span class="kw">library</span>(statthink)

<span class="co"># Add plot theme</span>
<span class="kw">theme_set</span>(<span class="kw">theme_statthinking</span>())

<span class="co"># Import data</span>
<span class="kw">head</span>(us_weather)</code></pre></div>
<pre><code>## # A tibble: 6 x 35
##   station date                dewpoint_avg drybulbtemp_avg relativehumidit…
##     &lt;dbl&gt; &lt;dttm&gt;                     &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;
## 1 7.25e10 2018-10-01 23:59:00           51              52               95
## 2 7.25e10 2018-10-02 23:59:00           59              60               96
## 3 7.25e10 2018-10-03 23:59:00           55              62               86
## 4 7.25e10 2018-10-04 23:59:00           56              60               77
## 5 7.25e10 2018-10-05 23:59:00           43              51               75
## 6 7.25e10 2018-10-06 23:59:00           62              63               90
## # … with 30 more variables: sealevelpressure_avg &lt;dbl&gt;,
## #   stationpressure_avg &lt;dbl&gt;, wetbulbtemp_avg &lt;dbl&gt;, windspeed_avg &lt;dbl&gt;,
## #   cooling_degree_days &lt;dbl&gt;, departure_from_normal_temperature &lt;dbl&gt;,
## #   heating_degree_days &lt;dbl&gt;, drybulbtemp_max &lt;dbl&gt;, drybulbtemp_min &lt;dbl&gt;,
## #   peak_wind_direction &lt;dbl&gt;, peak_wind_speed &lt;dbl&gt;, precipitation &lt;dbl&gt;,
## #   snow_depth &lt;dbl&gt;, snowfall &lt;dbl&gt;, wind_direction &lt;dbl&gt;, wind_speed &lt;dbl&gt;,
## #   weather_occurances &lt;chr&gt;, sunrise &lt;dbl&gt;, sunset &lt;dbl&gt;, month &lt;ord&gt;,
## #   month_numeric &lt;dbl&gt;, year &lt;dbl&gt;, day &lt;int&gt;, winter_group &lt;chr&gt;,
## #   location &lt;chr&gt;, fog &lt;chr&gt;, mist &lt;chr&gt;, drizzle &lt;chr&gt;, rain &lt;chr&gt;,
## #   snow &lt;chr&gt;</code></pre>
<p>Real world data are never as simple as exploring a distribution of a single variable, particularly when trying to understand individual variation. In most cases things interact, move in tandem, and many phenomena help to explain the variable of interest. For example, when thinking about admission rates, what may be some important factors that would explain some of the reasons why higher education institutions differ in their admission rates? Take a few minutes to brainstorm some ideas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_histogram</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_avg, <span class="dt">data =</span> us_weather, <span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>, 
          <span class="dt">title =</span> <span class="st">&quot;Univariate distribution of average daily temperature&quot;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_histogram</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_avg, <span class="dt">data =</span> us_weather, <span class="dt">bins =</span> <span class="dv">30</span>, 
             <span class="dt">fill =</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(snow)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>, 
          <span class="dt">title =</span> <span class="st">&quot;Multivariate distribution of average daily temperature by whether it snowed that day&quot;</span>,
          <span class="dt">fill =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Often density plots are easier to visualize when there are more than one group. To plot more than one density curve, we need to specify the color argument instead of fill.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_density</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_avg, <span class="dt">data =</span> us_weather, <span class="dt">size =</span> <span class="dv">1</span>,
             <span class="dt">color =</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(snow)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>, 
          <span class="dt">title =</span> <span class="st">&quot;Multivariate distribution of average daily temperature by whether it snowed that day&quot;</span>,
          <span class="dt">color =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_density</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_avg, <span class="dt">data =</span> us_weather, <span class="dt">size =</span> <span class="dv">1</span>,
             <span class="dt">fill =</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(snow)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>, 
          <span class="dt">title =</span> <span class="st">&quot;Multivariate distribution of average daily temperature by whether it snowed that day&quot;</span>,
          <span class="dt">fill =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_density</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_avg, <span class="dt">data =</span> us_weather, <span class="dt">color =</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(snow), 
           <span class="dt">fill =</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(snow), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>, 
          <span class="dt">title =</span> <span class="st">&quot;Multivariate distribution of average daily temperature by whether it snowed that day&quot;</span>,
          <span class="dt">fill =</span> <span class="st">&quot;&quot;</span>,
          <span class="dt">color =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_density</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_avg, <span class="dt">data =</span> us_weather, <span class="dt">color =</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(snow), 
           <span class="dt">fill =</span> <span class="st">&#39;gray75&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>, 
          <span class="dt">title =</span> <span class="st">&quot;Multivariate distribution of average daily temperature by whether it snowed that day&quot;</span>,
          <span class="dt">color =</span> <span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-6-1.png" width="672" /> ## Violin Plots</p>
<p>Violin plots are another way to make comparisons of distributions across groups. Violin plots are also easier to show more groups on a single graph. Violin plots are density plots that are mirrored to be fully enclosed. Best to explore with an example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_violin</span>(drybulbtemp_avg <span class="op">~</span><span class="st"> </span>snow, <span class="dt">data =</span> us_weather) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">y =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>,
          <span class="dt">title =</span> <span class="st">&#39;Multivariate distribution of average daily temperature by whether it snowed that day&#39;</span>,
          <span class="dt">x =</span> <span class="st">&quot;Snow?&quot;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_violin</span>(drybulbtemp_avg <span class="op">~</span><span class="st"> </span>snow, <span class="dt">data =</span> us_weather) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">y =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>,
          <span class="dt">title =</span> <span class="st">&#39;Multivariate distribution of average daily temperature by whether it snowed that day&#39;</span>,
          <span class="dt">x =</span> <span class="st">&quot;Snow?&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_refine</span>(<span class="kw">coord_flip</span>())</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Aesthetically, these figures are a bit more pleasing to look at if they include a light fill color. This is done similar to the density plots shown above with the <code>fill =</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_violin</span>(drybulbtemp_avg <span class="op">~</span><span class="st"> </span>snow, <span class="dt">data =</span> us_weather, <span class="dt">fill =</span> <span class="st">&#39;gray85&#39;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">y =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>,
          <span class="dt">title =</span> <span class="st">&#39;Multivariate distribution of average daily temperature by whether it snowed that day&#39;</span>, 
          <span class="dt">x =</span> <span class="st">&quot;Snow?&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_refine</span>(<span class="kw">coord_flip</span>())</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Adding quantiles are useful to aid in the comparison with the violin plots. These can be added with the <code>draw_quantiles</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_violin</span>(drybulbtemp_avg <span class="op">~</span><span class="st"> </span>snow, <span class="dt">data =</span> us_weather, <span class="dt">fill =</span> <span class="st">&#39;gray85&#39;</span>, 
          <span class="dt">draw_quantiles =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">y =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>,
          <span class="dt">title =</span> <span class="st">&#39;Multivariate distribution of average daily temperature by whether it snowed that day&#39;</span>,
          <span class="dt">x =</span> <span class="st">&quot;Snow?&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_refine</span>(<span class="kw">coord_flip</span>())</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-10-1.png" width="672" /> ### Violin Plots with many groups</p>
<p>Many groups are more easily shown in the violin plot framework.</p>
<p>With many groups, it is often of interest to put the long x-axis labels representing each group on the y-axis so that it reads the correct direction and the labels do not run into each other. This can be done with the <code>gf_refine()</code> function with <code>coord_flip()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_violin</span>(drybulbtemp_avg <span class="op">~</span><span class="st"> </span>location, <span class="dt">data =</span> us_weather, <span class="dt">fill =</span> <span class="st">&#39;gray85&#39;</span>, 
          <span class="dt">draw_quantiles =</span> <span class="kw">c</span>(.<span class="dv">1</span>, .<span class="dv">5</span>, .<span class="dv">9</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">y =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>,
          <span class="dt">title =</span> <span class="st">&#39;Multivariate distribution of average daily temperature by location&#39;</span>,
          <span class="dt">x =</span> <span class="st">&quot;Location&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_refine</span>(<span class="kw">coord_flip</span>())</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div id="facetting" class="section level2">
<h2><span class="header-section-number">4.1</span> Facetting</h2>
<p>Facetting is another way to explore distributions of two or more variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_violin</span>(drybulbtemp_avg <span class="op">~</span><span class="st"> </span>location, <span class="dt">data =</span> us_weather, <span class="dt">fill =</span> <span class="st">&#39;gray85&#39;</span>, 
          <span class="dt">draw_quantiles =</span> <span class="kw">c</span>(.<span class="dv">1</span>, .<span class="dv">5</span>, .<span class="dv">9</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">y =</span> <span class="st">&quot;Average daily temperature, in Fahrenheit&quot;</span>,
          <span class="dt">title =</span> <span class="st">&#39;Multivariate distribution of average daily temperature by location&#39;</span>,
          <span class="dt">x =</span> <span class="st">&quot;Location&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_refine</span>(<span class="kw">coord_flip</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_facet_wrap</span>(<span class="op">~</span><span class="st"> </span>snow)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="considering-groups" class="section level2">
<h2><span class="header-section-number">4.2</span> Considering Groups</h2>
<p>We've spent a lot of time trying to reason about other variables that may be important in explaining variation in our variable of interest. So far we have only explored the variable without considering other variables, in practice that is not that useful.</p>
<p>Instead, it is common to compute conditional statistics based on other characteristics in the data. An example may help to show the idea more clearly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">us_weather <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">df_stats</span>(drybulbtemp_max <span class="op">~</span><span class="st"> </span>location, median) </code></pre></div>
<pre><code>##          location median_drybulbtemp_max
## 1      Boston, MA                     48
## 2     Buffalo, NY                     42
## 3     Chicago, IL                     43
## 4     Detroit, MI                     45
## 5      Duluth, MN                     33
## 6   Iowa City, IA                     46
## 7 Minneapolis, MN                     38
## 8    Portland, ME                     43</code></pre>
<p>Presented above are the conditional medians for the higher education institutions in different areas of the country. More specifically, the data are essentially split into subgroups and the median is computed for each of those subgroups instead of pooling all institutions into a single data frame. The formula syntax is now <code>outcome ~ grouping</code> where the variable of interest (i.e. commonly a numeric variable) and the variable to the right of the <code>~</code> is the grouping variable. This syntax is similar to the violin plots that were created earlier.</p>
<p>Can you see differences in the admission rates across the regions?</p>
<p>One thing that is useful to add in when computing conditional statisics, is how many data points are in each group. This is particularly useful when the groups are different sizes, which is common. To do this, we can add another function to the <code>df_stats()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">us_weather <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">df_stats</span>(drybulbtemp_max <span class="op">~</span><span class="st"> </span>location, median, length) </code></pre></div>
<pre><code>##          location median_drybulbtemp_max length_drybulbtemp_max
## 1      Boston, MA                     48                    425
## 2     Buffalo, NY                     42                    425
## 3     Chicago, IL                     43                    425
## 4     Detroit, MI                     45                    425
## 5      Duluth, MN                     33                    425
## 6   Iowa City, IA                     46                    425
## 7 Minneapolis, MN                     38                    425
## 8    Portland, ME                     43                    425</code></pre>
<p>This adds another columns which represents the number of observations that went into the median calculation for each group. The syntax above also shows that you can add additional functions separated by a comma in the <code>df_stats()</code> function and are not limited to a single function. We will take advantage of this feature later on.</p>
<div id="adding-additional-groups" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Adding additional groups</h3>
<p>What if we thought more than one variable was important in explaining variation in the outcome variable? These can also be added to the <code>df_stats()</code> function for additional conditional statistics. The key is to add another variable to the right-hand side of the formula argument. More than one variable are separated with a <code>+</code> symbol.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">us_weather <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">df_stats</span>(drybulbtemp_max <span class="op">~</span><span class="st"> </span>location <span class="op">+</span><span class="st"> </span>month, median, length) </code></pre></div>
<pre><code>##           location month median_drybulbtemp_max length_drybulbtemp_max
## 1       Boston, MA   Jan                   42.0                     62
## 2      Buffalo, NY   Jan                   35.0                     62
## 3      Chicago, IL   Jan                   33.5                     62
## 4      Detroit, MI   Jan                   35.0                     62
## 5       Duluth, MN   Jan                   21.0                     62
## 6    Iowa City, IA   Jan                   32.0                     62
## 7  Minneapolis, MN   Jan                   25.5                     62
## 8     Portland, ME   Jan                   35.5                     62
## 9       Boston, MA   Feb                   42.0                     57
## 10     Buffalo, NY   Feb                   35.0                     57
## 11     Chicago, IL   Feb                   35.0                     57
## 12     Detroit, MI   Feb                   35.0                     57
## 13      Duluth, MN   Feb                   23.0                     57
## 14   Iowa City, IA   Feb                   34.0                     57
## 15 Minneapolis, MN   Feb                   26.0                     57
## 16    Portland, ME   Feb                   37.0                     57
## 17      Boston, MA   Mar                   46.0                     62
## 18     Buffalo, NY   Mar                   43.5                     62
## 19     Chicago, IL   Mar                   47.0                     62
## 20     Detroit, MI   Mar                   46.0                     62
## 21      Duluth, MN   Mar                   37.0                     62
## 22   Iowa City, IA   Mar                   50.0                     62
## 23 Minneapolis, MN   Mar                   43.0                     62
## 24    Portland, ME   Mar                   44.0                     62
## 25      Boston, MA   Apr                   54.0                     60
## 26     Buffalo, NY   Apr                   50.0                     60
## 27     Chicago, IL   Apr                   57.5                     60
## 28     Detroit, MI   Apr                   58.0                     60
## 29      Duluth, MN   Apr                   46.0                     60
## 30   Iowa City, IA   Apr                   61.0                     60
## 31 Minneapolis, MN   Apr                   54.5                     60
## 32    Portland, ME   Apr                   52.5                     60
## 33      Boston, MA   Oct                   62.5                     62
## 34     Buffalo, NY   Oct                   58.0                     62
## 35     Chicago, IL   Oct                   58.0                     62
## 36     Detroit, MI   Oct                   60.5                     62
## 37      Duluth, MN   Oct                   47.5                     62
## 38   Iowa City, IA   Oct                   60.0                     62
## 39 Minneapolis, MN   Oct                   52.0                     62
## 40    Portland, ME   Oct                   58.5                     62
## 41      Boston, MA   Nov                   49.0                     60
## 42     Buffalo, NY   Nov                   41.5                     60
## 43     Chicago, IL   Nov                   40.0                     60
## 44     Detroit, MI   Nov                   41.0                     60
## 45      Duluth, MN   Nov                   30.0                     60
## 46   Iowa City, IA   Nov                   42.5                     60
## 47 Minneapolis, MN   Nov                   33.5                     60
## 48    Portland, ME   Nov                   42.5                     60
## 49      Boston, MA   Dec                   42.0                     62
## 50     Buffalo, NY   Dec                   37.5                     62
## 51     Chicago, IL   Dec                   41.0                     62
## 52     Detroit, MI   Dec                   41.0                     62
## 53      Duluth, MN   Dec                   28.0                     62
## 54   Iowa City, IA   Dec                   41.0                     62
## 55 Minneapolis, MN   Dec                   32.0                     62
## 56    Portland, ME   Dec                   36.0                     62</code></pre>
</div>
</div>
<div id="other-statistics-of-center" class="section level2">
<h2><span class="header-section-number">4.3</span> Other statistics of center</h2>
<p>So far we have been discussing the median. The median attempts to provide a single number summary for the center of the distribution. It is a robust statistic, but likely isn't the most popular statistic to provide a location for the center of a distribution. The mean is often more commonly used as a measure of the center of a distribution. Part of this is due to the usage of the mean in common statistical methods and the mean also uses the values of all the data in the calculation. The median only considers the values of the middle score or scores, therefore this statistic is less sensitive to extreme values than the mean. I like to look at both statistics and this can provide some insight into the distribution of interest. We can add the mean using the <code>df_stats()</code> function by adding the function <code>mean</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stats_compute &lt;-<span class="st"> </span>us_weather <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">df_stats</span>(drybulbtemp_max <span class="op">~</span><span class="st"> </span>location, median, mean, length) 
stats_compute </code></pre></div>
<pre><code>##          location median_drybulbtemp_max mean_drybulbtemp_max
## 1      Boston, MA                     48             49.11294
## 2     Buffalo, NY                     42             43.77176
## 3     Chicago, IL                     43             44.84706
## 4     Detroit, MI                     45             45.63529
## 5      Duluth, MN                     33             33.23765
## 6   Iowa City, IA                     46             45.40471
## 7 Minneapolis, MN                     38             38.08471
## 8    Portland, ME                     43             43.96000
##   length_drybulbtemp_max
## 1                    425
## 2                    425
## 3                    425
## 4                    425
## 5                    425
## 6                    425
## 7                    425
## 8                    425</code></pre>
<p>Do you notice any trends in the direction the mean and median typically follow? More specifically, is the mean typically larger than the median or vice versa?</p>
<p>Let's visualize them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_histogram</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_max, <span class="dt">data =</span> us_weather, <span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gf_facet_wrap</span>(<span class="op">~</span><span class="st"> </span>location) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gf_vline</span>(<span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">xintercept =</span> <span class="op">~</span><span class="st"> </span>median_drybulbtemp_max, 
           <span class="dt">data =</span> stats_compute, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gf_vline</span>(<span class="dt">color =</span> <span class="st">&#39;lightblue&#39;</span>, <span class="dt">xintercept =</span> <span class="op">~</span><span class="st"> </span>mean_drybulbtemp_max, 
           <span class="dt">data =</span> stats_compute, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&#39;Maxmimum daily temperature&#39;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>What is different about the distributions that have larger differences in the mean and median?</p>
</div>
<div id="measures-of-variation" class="section level2">
<h2><span class="header-section-number">4.4</span> Measures of Variation</h2>
<p>So far we have focused primarily on applying functions to columns of data to provide a single numeric summary for where the center of the distribution may lie. The center of the distribution is important, however the primary goal in research and with statistics is to try to understand the variation in the distribution.</p>
<p>One crude measure of variation that is intuitive is the range of a variable. The range is the difference between the smallest and the largest number in the data. We can compute this with the <code>df_stats()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> us_weather <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">df_stats</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_max, range) </code></pre></div>
<pre><code>##   range_drybulbtemp_max_1 range_drybulbtemp_max_2
## 1                     -14                      89</code></pre>
<p>The details of the <code>df_stats()</code> function are in the previous course notes. The output for this computation returns two values, the minimum and maximum value in the data and unsurprisingly, is 0 and 1 respectively.</p>
<div id="robust-measure-of-variation" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Robust measure of variation</h3>
<p>The idea behind the IQR representing differences in percentiles allows us to extend this to different percentiles that may be more directly interpretable for a given situation. For example, suppose we wanted to know how spread out the middle 80% of the distribution is. We can do this directly by computing the 90th and 10th percentiles and finding the difference between the two.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> mid_<span class="dv">80</span> &lt;-<span class="st"> </span>us_weather <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">df_stats</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_max, <span class="kw">quantile</span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)), <span class="dt">nice_names =</span> <span class="ot">TRUE</span>) 
 mid_<span class="dv">80</span> </code></pre></div>
<pre><code>##   X10. X90.
## 1   25   62</code></pre>
<p>As you can see, once you extend the amount of the distribution contained, the distance increases, now to 0.555 or 55.5% the the range of the middle 80% of the admission rate distribution. We can also visualize what this looks like.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">gf_histogram</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_max, <span class="dt">data =</span> us_weather, 
              <span class="dt">bins =</span> <span class="dv">30</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">gf_vline</span>(<span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">xintercept =</span> <span class="op">~</span><span class="st"> </span>value, 
            <span class="dt">data =</span> <span class="kw">gather</span>(mid_<span class="dv">80</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&#39;Maxmimum daily temperature&#39;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>We can also view the exact percentages using the empirical cumulative density function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">gf_ecdf</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_max, <span class="dt">data =</span> us_weather) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">gf_vline</span>(<span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">xintercept =</span> <span class="op">~</span><span class="st"> </span>value, <span class="dt">data =</span> <span class="kw">gather</span>(mid_<span class="dv">80</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&#39;Maxmimum daily temperature&#39;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="variation-by-group" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Variation by Group</h3>
<p>These statistics can also be calculated by different grouping variables similar to what was done with statisitcs of center. Now the variable of interest is on the left-hand side of the equation and the grouping variable is on the right hand side.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> iqr_groups &lt;-<span class="st"> </span>us_weather <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">df_stats</span>(drybulbtemp_max <span class="op">~</span><span class="st"> </span>location, IQR, <span class="kw">quantile</span>(<span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)), 
            <span class="dt">nice_names =</span> <span class="ot">TRUE</span>) 
 iqr_groups </code></pre></div>
<pre><code>##          location IQR_drybulbtemp_max X25. X75.
## 1      Boston, MA                  16   41   57
## 2     Buffalo, NY                  17   35   52
## 3     Chicago, IL                  18   35   53
## 4     Detroit, MI                  18   36   54
## 5      Duluth, MN                  18   24   42
## 6   Iowa City, IA                  22   34   56
## 7 Minneapolis, MN                  21   28   49
## 8    Portland, ME                  16   36   52</code></pre>
<p>This can also be visualized to see how these statistics vary across the groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">gf_histogram</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_max, <span class="dt">data =</span> us_weather, <span class="dt">bins =</span> <span class="dv">30</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">gf_vline</span>(<span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">xintercept =</span> <span class="op">~</span><span class="st"> </span>value,  
      <span class="dt">data =</span> <span class="kw">filter</span>(<span class="kw">pivot_longer</span>(iqr_groups, IQR_drybulbtemp_max<span class="op">:</span><span class="st">&#39;X75.&#39;</span>), 
                    name <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;X25.&#39;</span>, <span class="st">&#39;X75.&#39;</span>)), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">gf_facet_wrap</span>(<span class="op">~</span><span class="st"> </span>location) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&#39;Maxmimum daily temperature&#39;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">gf_ecdf</span>(<span class="op">~</span><span class="st"> </span>drybulbtemp_max, <span class="dt">data =</span> us_weather) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">gf_vline</span>(<span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">xintercept =</span> <span class="op">~</span><span class="st"> </span>value,  
      <span class="dt">data =</span> <span class="kw">filter</span>(<span class="kw">pivot_longer</span>(iqr_groups, IQR_drybulbtemp_max<span class="op">:</span><span class="st">&#39;X75.&#39;</span>), 
                    name <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;X25.&#39;</span>, <span class="st">&#39;X75.&#39;</span>)), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">gf_facet_wrap</span>(<span class="op">~</span><span class="st"> </span>location) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">x =</span> <span class="st">&#39;Maxmimum daily temperature&#39;</span>)</code></pre></div>
<p><img src="04-multivariate-visualization_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="descriptive-statistics-numerically-describing-the-sample-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="classification.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
